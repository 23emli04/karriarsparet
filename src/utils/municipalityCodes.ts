/**
 * Maps Swedish municipality codes (4-digit, e.g. 0180) to official names.
 * Codes are from SCB (Statistics Sweden). Normalized to 4-digit string.
 */
import { createResolverMethods } from "./codeResolver";

const MUNICIPALITY_CODE_TO_NAME: Record<string, string> = {
  "0114": "Upplands Väsby",
  "0115": "Vallentuna",
  "0117": "Österåker",
  "0118": "Värmdö",
  "0125": "Järfälla",
  "0126": "Huddinge",
  "0127": "Botkyrka",
  "0128": "Salem",
  "0136": "Haninge",
  "0138": "Tyresö",
  "0139": "Upplands-Bro",
  "0140": "Nykvarn",
  "0160": "Täby",
  "0162": "Danderyd",
  "0163": "Sollentuna",
  "0180": "Stockholm",
  "0181": "Södertälje",
  "0182": "Nacka",
  "0183": "Sundbyberg",
  "0184": "Solna",
  "0186": "Lidingö",
  "0187": "Vaxholm",
  "0188": "Norrtälje",
  "0191": "Sigtuna",
  "0192": "Nynäshamn",
  "0305": "Håbo",
  "0319": "Älvkarleby",
  "0330": "Knivsta",
  "0331": "Heby",
  "0360": "Tierp",
  "0380": "Uppsala",
  "0381": "Enköping",
  "0382": "Östhammar",
  "0428": "Vingåker",
  "0461": "Gnesta",
  "0480": "Nyköping",
  "0481": "Oxelösund",
  "0482": "Flen",
  "0483": "Katrineholm",
  "0484": "Eskilstuna",
  "0486": "Strängnäs",
  "0488": "Trosa",
  "0509": "Ödeshög",
  "0512": "Ydre",
  "0513": "Kinda",
  "0560": "Boxholm",
  "0561": "Åtvidaberg",
  "0562": "Finspång",
  "0563": "Valdemarsvik",
  "0580": "Linköping",
  "0581": "Norrköping",
  "0582": "Söderköping",
  "0583": "Motala",
  "0584": "Vadstena",
  "0586": "Mjölby",
  "0604": "Aneby",
  "0617": "Gnosjö",
  "0642": "Mullsjö",
  "0643": "Habo",
  "0662": "Gislaved",
  "0665": "Vaggeryd",
  "0680": "Jönköping",
  "0682": "Nässjö",
  "0683": "Värnamo",
  "0684": "Sävsjö",
  "0685": "Vetlanda",
  "0686": "Eksjö",
  "0687": "Tranås",
  "0760": "Uppvidinge",
  "0761": "Lessebo",
  "0763": "Tingsryd",
  "0764": "Alvesta",
  "0765": "Älmhult",
  "0767": "Markaryd",
  "0780": "Växjö",
  "0781": "Ljungby",
  "0821": "Högsby",
  "0834": "Torsås",
  "0840": "Mörbylånga",
  "0860": "Hultsfred",
  "0861": "Mönsterås",
  "0862": "Emmaboda",
  "0880": "Kalmar",
  "0881": "Nybro",
  "0882": "Oskarshamn",
  "0883": "Västervik",
  "0884": "Vimmerby",
  "0885": "Borgholm",
  "0980": "Gotland",
  "1060": "Olofström",
  "1080": "Karlskrona",
  "1081": "Ronneby",
  "1082": "Karlshamn",
  "1083": "Sölvesborg",
  "1214": "Svalöv",
  "1230": "Staffanstorp",
  "1231": "Burlöv",
  "1233": "Kävlinge",
  "1234": "Lomma",
  "1256": "Svedala",
  "1257": "Skurup",
  "1260": "Sjöbo",
  "1261": "Hörby",
  "1262": "Höör",
  "1263": "Tomelilla",
  "1264": "Bromölla",
  "1265": "Osby",
  "1266": "Perstorp",
  "1267": "Klippan",
  "1270": "Kristianstad",
  "1272": "Simrishamn",
  "1273": "Ängelholm",
  "1275": "Hässleholm",
  "1276": "Hörby",
  "1277": "Östra Göinge",
  "1278": "Örkelljunga",
  "1280": "Malmö",
  "1281": "Lund",
  "1282": "Landskrona",
  "1283": "Helsingborg",
  "1284": "Höganäs",
  "1285": "Eslöv",
  "1286": "Ystad",
  "1287": "Trelleborg",
  "1290": "Vellinge",
  "1291": "Skanör med Falsterbo",
  "1292": "Skurup",
  "1293": "Sjöbo",
  "1315": "Hylte",
  "1380": "Halmstad",
  "1381": "Laholm",
  "1382": "Falkenberg",
  "1383": "Varberg",
  "1384": "Kungsbacka",
  "1401": "Härryda",
  "1402": "Partille",
  "1407": "Öckerö",
  "1415": "Stenungsund",
  "1419": "Tjörn",
  "1421": "Orust",
  "1427": "Sotenäs",
  "1430": "Munkedal",
  "1435": "Tanum",
  "1438": "Dals-Ed",
  "1439": "Färgelanda",
  "1440": "Ale",
  "1441": "Lerum",
  "1442": "Vårgårda",
  "1443": "Bollebygd",
  "1444": "Grästorp",
  "1445": "Essunga",
  "1446": "Karlsborg",
  "1447": "Gullspång",
  "1452": "Tranemo",
  "1460": "Bengtsfors",
  "1461": "Mellerud",
  "1462": "Lilla Edet",
  "1463": "Mark",
  "1465": "Svenljunga",
  "1466": "Herrljunga",
  "1470": "Vara",
  "1471": "Grästorp",
  "1472": "Tibro",
  "1473": "Töreboda",
  "1480": "Göteborg",
  "1481": "Mölndal",
  "1482": "Kungälv",
  "1484": "Lysekil",
  "1485": "Uddevalla",
  "1486": "Vänersborg",
  "1487": "Trollhättan",
  "1488": "Alingsås",
  "1489": "Borås",
  "1490": "Ulricehamn",
  "1491": "Åmål",
  "1492": "Mariestad",
  "1493": "Lidköping",
  "1494": "Skara",
  "1495": "Skövde",
  "1496": "Hjo",
  "1497": "Tidaholm",
  "1498": "Falköping",
  "1499": "Tranemo",
  "1715": "Kil",
  "1730": "Eda",
  "1737": "Torsby",
  "1760": "Storfors",
  "1761": "Hammarö",
  "1762": "Munkfors",
  "1763": "Forshaga",
  "1764": "Grums",
  "1765": "Årjäng",
  "1766": "Sunne",
  "1780": "Karlstad",
  "1781": "Kristinehamn",
  "1782": "Filipstad",
  "1783": "Hagfors",
  "1784": "Arvika",
  "1785": "Säffle",
  "1814": "Lekeberg",
  "1860": "Laxå",
  "1861": "Hallsberg",
  "1862": "Degerfors",
  "1863": "Hällefors",
  "1864": "Ljusnarsberg",
  "1880": "Örebro",
  "1881": "Kumla",
  "1882": "Askersund",
  "1883": "Karlskoga",
  "1884": "Nora",
  "1885": "Lindesberg",
  "1904": "Skinnskatteberg",
  "1907": "Surahammar",
  "1960": "Kungsör",
  "1961": "Hallstahammar",
  "1962": "Norberg",
  "1980": "Västerås",
  "1981": "Sala",
  "1982": "Fagersta",
  "1983": "Köping",
  "1984": "Arboga",
  "2021": "Vansbro",
  "2023": "Malung-Sälen",
  "2026": "Gagnef",
  "2029": "Leksand",
  "2031": "Rättvik",
  "2034": "Orsa",
  "2039": "Älvdalen",
  "2061": "Smedjebacken",
  "2062": "Mora",
  "2080": "Falun",
  "2081": "Borlänge",
  "2082": "Säter",
  "2083": "Hedemora",
  "2084": "Avesta",
  "2085": "Ludvika",
  "2101": "Ockelbo",
  "2104": "Hofors",
  "2121": "Ovanåker",
  "2132": "Nordanstig",
  "2161": "Ljusdal",
  "2180": "Gävle",
  "2181": "Sandviken",
  "2182": "Söderhamn",
  "2183": "Bollnäs",
  "2184": "Hudiksvall",
  "2260": "Ånge",
  "2262": "Timrå",
  "2280": "Härnösand",
  "2281": "Sundsvall",
  "2282": "Kramfors",
  "2283": "Sollefteå",
  "2284": "Örnsköldsvik",
  "2303": "Ragunda",
  "2305": "Bräcke",
  "2309": "Krokom",
  "2313": "Strömsund",
  "2321": "Åre",
  "2326": "Berg",
  "2361": "Härjedalen",
  "2380": "Östersund",
  "2401": "Nordmalings",
  "2403": "Bjurholm",
  "2404": "Vindeln",
  "2409": "Robertsfors",
  "2417": "Norsjö",
  "2418": "Malå",
  "2421": "Storuman",
  "2422": "Sorsele",
  "2425": "Dorotea",
  "2460": "Vännäs",
  "2462": "Vilhelmina",
  "2463": "Åsele",
  "2480": "Umeå",
  "2481": "Lycksele",
  "2482": "Skellefteå",
  "2505": "Arvidsjaur",
  "2506": "Arjeplog",
  "2510": "Jokkmokk",
  "2513": "Överkalix",
  "2514": "Kalix",
  "2518": "Övertorneå",
  "2521": "Pajala",
  "2523": "Gällivare",
  "2560": "Älvsbyn",
  "2580": "Luleå",
  "2581": "Piteå",
  "2582": "Boden",
  "2583": "Haparanda",
  "2584": "Kiruna",
};

function normalizeMunicipalityCode(code: string | undefined): string {
  if (code == null || code === "") return "";
  const digits = code.replace(/\D/g, "");
  return digits.length <= 4 ? digits.padStart(4, "0") : digits.slice(-4);
}

const { getName, getNames, getNamesString } = createResolverMethods(
  MUNICIPALITY_CODE_TO_NAME,
  normalizeMunicipalityCode
);

/** Get the municipality name for a single code. Returns the code if not found. */
export const getMunicipalityName = getName;

/** Get municipality names for an array of codes. Skips empty/unknown. */
export function getMunicipalityNames(codes: (string | undefined)[] | undefined): string[] {
  return getNames(codes);
}

/** Get municipality names as a single string (e.g. "Stockholm, Göteborg, Malmö"). */
export function getMunicipalityNamesString(codes: (string | undefined)[] | undefined): string {
  return getNamesString(codes);
}

/**
 * Class to resolve municipality codes to names.
 */
export class MunicipalityCodes {
  static getName(code: string | undefined): string {
    return getMunicipalityName(code);
  }

  static getNames(codes: (string | undefined)[] | undefined): string[] {
    return getMunicipalityNames(codes);
  }

  static getNamesString(codes: (string | undefined)[] | undefined): string {
    return getMunicipalityNamesString(codes);
  }
}
